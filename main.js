(()=>{var e={13:(e,t,a)=>{const r=a(113);e.exports=class{constructor(){this.board=this.createGrid(),this.allShips=[],this.createGrid()}createGrid(){this.board=[];for(let e=0;e<10;e++){this.board[e]=[];for(let t=0;t<10;t++)this.board[e].push({hasShip:"",isShot:!1})}}placeShip(e,t,a){let o=t[0],s=t[1];const n=this.getShipId(),d=new r(e,n);this.allShips.push(d);for(let t=0;t<e;t++)this.board[o][s].hasShip=n,"vertical"===a?o++:s++}recieveAttack(e,t){if(!this.board[e][t].isShot&&(this.board[e][t].isShot=!0,this.checkHasShip(e,t))){const a=this.getAttackedShip(e,t);a.hit([e,t]),a.checkSunkState()}}checkShipPlacementValidity(e,t,a,r){let o=t,s=a;for(let t=0;t<e;t++){if(""!==this.board[o][s].hasShip)return!1;"vertical"===r?o++:"horizontal"===r&&s++}return!0}getShipId(){return this.allShips.length}checkHasShip(e,t){return""!==this.board[e][t].hasShip}getAttackedShip(e,t){const a=Number(this.board[e][t].hasShip);return this.allShips[a]}checkAllShipsAreSunk(){return this.allShips.filter((e=>e.isSunk)).length===this.allShips.length}}},926:(e,t,a)=>{const r=a(13);e.exports=class{constructor(e){this.name=e,this.gameboard=new r,this.moves=[],this.smartMoves=[]}attack(e,t,a){e.gameboard.recieveAttack(t,a)}restartPlayer(){this.moves=[],this.smartMoves=[],this.gameboard=new r}}},113:e=>{e.exports=class{constructor(e,t){this.shipId=t,this.length=e,this.hits=[],this.isSunk=!1}hit(e){this.hits.push(e)}checkSunkState(){this.length===this.hits.length&&(this.isSunk=!0)}}}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,a),s.exports}(()=>{"use strict";const e=(()=>{const e=(e,t)=>{const a=JSON.stringify(t);return e.some((e=>JSON.stringify(e)===a))},t=a=>{console.log("getRandomCoord");let r=`0${Math.floor(100*Math.random())}`;r=r.slice(-2);const o=r.split("").map(Number);return e(a.moves,o)?t(a):(a.moves.push(o),o)};return{getCoord:e=>{if(0!==e.smartMoves.length){const t=e.smartMoves[0];return e.moves.push(t),e.smartMoves.shift(),t}return t(e)},calculateNextBestCoord:(t,a,r)=>{const o=r[0],s=r[1];if(""===a.gameboard.board[o][s].hasShip)return;const n=[[o,s+1],[o,s-1],[o+1,s],[o-1,s]];n.slice().forEach((a=>{if(console.log(a),console.log("forEach"),a[0]<0||a[0]>9||a[1]<0||a[1]>9){console.log("minus outside range");const e=n.findIndex((e=>JSON.stringify(e)===JSON.stringify(a)));n.splice(e,1)}if(e(t.moves,a)){console.log("already played");const e=n.findIndex((e=>JSON.stringify(e)===JSON.stringify(a)));n.splice(e,1)}})),n.forEach((e=>{t.smartMoves.push(e)}))}}})(),t=(()=>{const e=e=>{e.dataTransfer.setData("text",e.target.className),console.log("dragging")},t=e=>{console.log(e.target.className.includes("ship-mark")),e.dataTransfer.getData("text"),e.target.className.includes("ship-mark")?e.target.classList.add("can-not-drop"):(e.target.classList.add("can-drop"),e.preventDefault())},a=e=>{console.log(e.target.classList),e.target.draggable=!1,e.target.classList.remove("can-not-drop"),e.target.classList.remove("can-drop")},r=e=>{const t=e.dataTransfer.getData("text");e.target.className=t,e.target.draggable=!0,e.preventDefault()};return{activateDragStartEvent:()=>{document.querySelectorAll("[draggable=true]").forEach((t=>{t.addEventListener("dragstart",e)}))},activateDragOverEvent:e=>{e.addEventListener("dragleave",a),e.addEventListener("dragover",t)},activateDropEvent:e=>{e.addEventListener("drop",r)}}})(),r=(()=>{const e=e=>e[0]>9||e[1]>9||e[0]<0||e[1]<0,t=(t,a,r,o)=>{let s=!1,n=Number(a[0]),d=Number(a[1]);for(let a=0;a<r;a++){const a=[[n+1,d],[n-1,d],[n,d+1],[n,d-1],[n-1,d-1],[n-1,d+1],[n+1,d+1],[n+1,d-1]].filter((t=>!e(t)));console.log(a);for(let e=0;e<a.length;e++){const r=a[e][0],o=a[e][1];""!==t.gameboard.board[r][o].hasShip&&(s=!0)}""!==t.gameboard.board[n][d].hasShip&&(s=!0),"horizontal"===o?d++:n++}return s},a=(e,r,o)=>{let s,n;return"horizontal"===o?(s=Math.floor(10*Math.random()),n=Math.floor(Math.random()*(10-r))):(s=Math.floor(Math.random()*(10-r)),n=Math.floor(10*Math.random())),t(e,[s,n],r,o)?a(e,r,o):[s,n]};return{placeShipRandomly:e=>{[5,4,3,2,2,1].forEach((t=>{const r=["horizontal","vertical"][Math.floor(2*Math.random())],o=a(e,t,r);e.gameboard.placeShip(t,o,r)}))},hoverShipUI:(e,t,a)=>{const r=e.dataset.row,o=e.dataset.col;let s=t;if("horizontal"===a){let e="green-hovered-tile";t>10-o&&(s=10-o,e="red-hovered-tile");for(let t=0;t<s;t++){const a=r,s=Number(o)+t;document.querySelector(`#human-grid [data-row="${a}"][data-col="${s}"]`).classList.add(e)}}},removeHoverShipUI:()=>{document.querySelectorAll(".green-hovered-tile").forEach((e=>{e.classList.remove("green-hovered-tile")})),document.querySelectorAll(".red-hovered-tile").forEach((e=>{e.classList.remove("red-hovered-tile")}))},checkAlreadyHasShip:t}})(),o=(()=>{const e=(e,t,a)=>{"computer"===e.name?document.querySelector(`#computer-grid [data-row="${t}"][data-col="${a}"]`).classList.add("red-mark"):document.querySelector(`#human-grid [data-row="${t}"][data-col="${a}"]`).classList.add("red-mark")},a=(e,t,a)=>{"computer"===e.name?document.querySelector(`#computer-grid [data-row="${t}"][data-col="${a}"]`).classList.add("missed-mark"):document.querySelector(`#human-grid [data-row="${t}"][data-col="${a}"]`).classList.add("missed-mark")},r=(e,t,a,r)=>{if("computer"===e.name)document.querySelector(`#computer-grid [data-row="${t}"][data-col="${a}"]`).classList.add("ship-mark");else{const e=document.querySelector(`#human-grid [data-row="${t}"][data-col="${a}"]`);e.classList.add(`ship-mark${r}`),e.draggable=!0}},o=e=>{const t=e.gameboard.allShips.filter((e=>!1===e.isSunk));document.querySelector(`.${e.name}-side .ship-num`).textContent=`Ships Remaining: ${t.length}`},s=()=>{const e=document.getElementById("human-grid"),a=document.getElementById("computer-grid");for(let r=0;r<10;r++)for(let o=0;o<10;o++){const s=document.createElement("div");s.classList.add("tile"),s.dataset.row=r,s.dataset.col=o;const n=document.createElement("div");n.classList.add("tile"),n.dataset.row=r,n.dataset.col=o,t.activateDragOverEvent(n),t.activateDropEvent(n),e.appendChild(n),a.appendChild(s)}};return{createBoard:s,render:t=>{for(let o=0;o<10;o++)for(let s=0;s<10;s++){t.gameboard.board[o][s].isShot&&""!==t.gameboard.board[o][s].hasShip?e(t,o,s):t.gameboard.board[o][s].isShot&&""===t.gameboard.board[o][s].hasShip&&a(t,o,s);const n=t.gameboard.board[o][s].hasShip;""!==n&&"human"===t.name&&r(t,o,s,n)}o(t)},declareWinner:e=>{const t=document.querySelector(".announcement");"computer"===e.name?t.textContent="You Lose!":t.textContent="You Won!"},updateRemainingShip:o,disableBoardEvent:(e,t)=>{const a=e.name,r=document.querySelector(`#${a}-grid`);r.classList.add("no-event"),t&&r.classList.toggle("fade")},restartBoard:()=>{document.getElementById("human-grid").textContent="",document.getElementById("computer-grid").textContent="",document.querySelectorAll(".ship-num").forEach((e=>{e.textContent="Ships Remaining: 6"})),s()},enableBoardEvent:e=>{const t=e.name,a=document.querySelector(`#${t}-grid`);a.classList.remove("no-event"),a.classList.remove("fade")}}})(),s=a(926),n=(()=>{const t=new s("human"),a=new s("computer"),n=()=>{o.restartBoard(),o.enableBoardEvent(t),o.enableBoardEvent(a),t.restartPlayer(),a.restartPlayer()},d=(e,t)=>{t.gameboard.checkAllShipsAreSunk()&&(o.declareWinner(e),o.disableBoardEvent(e,!0),o.disableBoardEvent(t,!0))};return{startGame:()=>{r.placeShipRandomly(a),o.render(a)},startAttackRound:(r,s)=>{t.attack(a,r,s),o.render(a),d(t,a);const n=e.getCoord(a,t);e.calculateNextBestCoord(a,t,n),a.attack(t,n[0],n[1]),o.render(t),d(a,t)},restartGame:n,randomizeShip:()=>{n(),r.placeShipRandomly(t),o.disableBoardEvent(t,!1),o.render(t)},placeShipManually:e=>{console.log("clicked");const a=[5,4,3,2,2,1][t.gameboard.allShips.length],s=e.target.dataset.row,n=e.target.dataset.col;r.checkAlreadyHasShip(t,[s,n],a,"horizontal")||t.gameboard.placeShip(a,[s,n],"horizontal"),o.render(t),t.gameboard.allShips.length>5&&o.disableBoardEvent(t,!1)},displayHoverEffect:e=>{r.removeHoverShipUI();const a=t.gameboard.allShips.length;r.hoverShipUI(e.target,[5,4,3,2,2,1][a],"horizontal")}}})(),d=(()=>{const e=()=>{document.querySelectorAll("#computer-grid .tile").forEach((e=>{e.addEventListener("click",(e=>{const t=Number(e.target.dataset.row),a=Number(e.target.dataset.col);n.startAttackRound(t,a)}))}))};return{startButtonEvent:()=>{document.getElementById("start").addEventListener("click",(()=>{n.startGame(),e()})),document.getElementById("restart").addEventListener("click",(()=>{n.restartGame(),e()})),document.getElementById("randomize").addEventListener("click",n.randomizeShip),document.getElementById("reset").addEventListener("click",n.restartGame)},startPlaceShipsEvent:()=>{const e=document.querySelector("#human-grid");e.addEventListener("mouseover",n.displayHoverEffect),e.addEventListener("mouseleave",r.removeHoverShipUI),e.addEventListener("click",n.placeShipManually)}}})();o.createBoard(),d.startButtonEvent(),d.startPlaceShipsEvent()})()})();